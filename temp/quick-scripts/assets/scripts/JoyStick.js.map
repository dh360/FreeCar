{"version":3,"sources":["JoyStick.js"],"names":["cc","Class","extends","Component","properties","dot","default","type","Node","displayName","player","ring","onLoad","console","log","radius","width","center","getAnchorPoint","centerX","anchorX","centerY","anchorY","height","initListenerEvent","touchStartHandler","event","touchPos","node","convertToNodeSpaceAR","getLocation","figerPosition","distance","sub","getPosition","mag","setPosition","touchEndHandler","on","EventType","TOUCH_START","TOUCH_MOVE","TOUCH_END","touchEndEvent","TOUCH_CANCEL"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,aAAK,EAAE;AACHC,qBAAS,IADR;AAEDC,kBAAMP,GAAGQ,IAFR;AAGDC,yBAAa;;AAHZ,SADG;AAORC,gBAAQ,EAAE;AACNJ,qBAAS,IADL;AAEJC,kBAAMP,GAAGQ,IAFL;AAGJC,yBAAa;AAHT,SAPA;AAYRE,cAAM,EAAE;AACJL,qBAAS,IADP;AAEFC,kBAAMP,GAAGQ,IAFP;AAGFC,yBAAa;AAHX;AAZE,KAHP;;AAsBLG,UAtBK,oBAsBI;AACL;AACAC,gBAAQC,GAAR,CAAY,QAAZ;;AAEA,aAAKC,MAAL,GAAc,KAAKJ,IAAL,CAAUK,KAAV,GAAkB,CAAhC,CAJK,CAI8B;AACnC,YAAIC,SAAS,KAAKN,IAAL,CAAUO,cAAV,EAAb,CALK,CAKoC;AACzC,YAAIC,UAAU,KAAKR,IAAL,CAAUS,OAAV,GAAoB,KAAKT,IAAL,CAAUK,KAA5C;AACA,YAAIK,UAAU,KAAKV,IAAL,CAAUW,OAAV,GAAoB,KAAKX,IAAL,CAAUY,MAA5C;AACA,aAAKC,iBAAL;AAEH,KAhCI;;;AAkCL;AACAC,qBAnCK,6BAmCaC,KAnCb,EAmCoB;AACrB,YAAMC,WAAW,KAAKC,IAAL,CAAUC,oBAAV,CAA+BH,MAAMI,WAAN,EAA/B,CAAjB;;AAEA,YAAIC,gBAAgBL,MAAMI,WAAN,EAApB,CAHqB,CAGoB;AACzCjB,gBAAQC,GAAR,CAAY,QAAZ,EAAsBiB,aAAtB;AACA,YAAMC,WAAWL,SAASM,GAAT,CAAa,KAAKtB,IAAL,CAAUuB,WAAV,EAAb,EAAsCC,GAAtC,EAAjB;;AAEA,YAAIH,YAAY,KAAKjB,MAArB,EAA6B;AACzB,iBAAKV,GAAL,CAAS+B,WAAT,CAAqBT,QAArB;AACH;AACJ,KA7CI;AA+CLU,mBA/CK,2BA+CWX,KA/CX,EA+CkB,CAGtB,CAlDI;AAqDLF,qBArDK,+BAqDe;AAChB,aAAKI,IAAL,CAAUU,EAAV,CAAatC,GAAGQ,IAAH,CAAQ+B,SAAR,CAAkBC,WAA/B,EAA4C,KAAKf,iBAAjD,EAAoE,IAApE;AACA,aAAKG,IAAL,CAAUU,EAAV,CAAatC,GAAGQ,IAAH,CAAQ+B,SAAR,CAAkBE,UAA/B,EAA2C,KAAKJ,eAAhD,EAAiE,IAAjE;AACA,aAAKT,IAAL,CAAUU,EAAV,CAAatC,GAAGQ,IAAH,CAAQ+B,SAAR,CAAkBG,SAA/B,EAA0C,KAAKC,aAA/C,EAA8D,IAA9D;AACA,aAAKf,IAAL,CAAUU,EAAV,CAAatC,GAAGQ,IAAH,CAAQ+B,SAAR,CAAkBK,YAA/B,EAA6C,KAAKD,aAAlD,EAAiE,IAAjE;AACH;AA1DI,CAAT","file":"JoyStick.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        dot: { //圆点\n            default: null,\n            type: cc.Node,\n            displayName: 'DOT',\n\n        },\n        player: { //小车\n            default: null,\n            type: cc.Node,\n            displayName: 'player',\n        },\n        ring: { //圆圈\n            default: null,\n            type: cc.Node,\n            displayName: 'Ring'\n        }\n    },\n\n    onLoad() {\n        //挂载监听事件\n        console.log('挂载 主场景');\n\n        this.radius = this.ring.width / 2; // 半径\n        let center = this.ring.getAnchorPoint(); //ring节点圆心\n        let centerX = this.ring.anchorX * this.ring.width;\n        let centerY = this.ring.anchorY * this.ring.height;\n        this.initListenerEvent();\n\n    },\n\n    //\n    touchStartHandler(event) {\n        const touchPos = this.node.convertToNodeSpaceAR(event.getLocation());\n\n        let figerPosition = event.getLocation(); // 获取鼠标/手指触摸位置\n        console.log('手指触摸位置', figerPosition);\n        const distance = touchPos.sub(this.ring.getPosition()).mag();\n\n        if (distance <= this.radius) {\n            this.dot.setPosition(touchPos);\n        }\n    },\n\n    touchEndHandler(event) {\n\n\n    },\n\n\n    initListenerEvent() {\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touchStartHandler, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touchEndHandler, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touchEndEvent, this);\n        this.node.on(cc.Node.EventType.TOUCH_CANCEL, this.touchEndEvent, this);\n    }\n});"]}