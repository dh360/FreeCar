{"version":3,"sources":["../../../../assets/scripts/assets/scripts/main.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../assets/scripts","sourcesContent":["const {ccclass, property} = cc._decorator;\n\nconst SPEED = 400;   // 这个速度应该跟小车的移动速度保持一致\nconst WIDTH = 960;\nconst HEIGHT = 640;\n\n@ccclass\nexport default class Main extends cc.Component {\n    @property(cc.Node) RoleNode: cc.Node = null;\n    @property(cc.Node) BgArr: cc.Node[] = [];\n    @property(cc.Node) CameraNode: cc.Node = null;\n    @property(cc.Node) stick: cc.Node = null;\n\n    /** 四个方向输入指令 */\n\tprivate _input = {  \n\t\tleft: false,\n\t\tright: false,\n        up: false,\n        down: false,\n\t};\n\n    onLoad() {\n        // 注册按键监听\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    }\n    \n    onDestroy() {\n        // 清除按键监听\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);   \n    }\n\n    update(dt: number) {\n        if (this._input.left) {\n            this.RoleNode.x -= dt * SPEED;\n        } else if (this._input.right) {\n            this.RoleNode.x += dt * SPEED;\n        }\n        if (this._input.up) {\n            this.RoleNode.y += dt * SPEED;\n        } else if (this._input.down) {\n            this.RoleNode.y -= dt * SPEED;\n        }\n\n        // 摄像机跟随role\n        this.CameraNode.position = this.RoleNode.position;\n\n        // 根据摄像机位置设置背景坐标\n        this.BgArr.forEach((e) => {\n            if (e.x < this.CameraNode.x - WIDTH) {\n                e.x += 2 * WIDTH\n            } else if (e.x > this.CameraNode.x + WIDTH) {\n                e.x -= 2 * WIDTH;\n            }\n            if (e.y < this.CameraNode.y - HEIGHT) {\n                e.y += 2 * HEIGHT;\n            } else if (e.y > this.CameraNode.y + WIDTH) {\n                e.y -= 2 * HEIGHT;\n            }\n        });\n    }\n\n    /** 按下按键 */\n\tprivate onKeyDown (event: cc.Event.EventKeyboard) {\n        switch (event.keyCode) {\n            case cc.macro.KEY.a:\n                this._input.left = true;\n                this._input.right = false;\n\t\t\t\tbreak;\n\t\t\tcase cc.macro.KEY.d:\n                this._input.left = false;\n                this._input.right = true;\n\t\t\t\tbreak;\n\t\t\tcase cc.macro.KEY.w:\n                this._input.up = true;\n                this._input.down = false;\n                break;\n            case cc.macro.KEY.s:\n                this._input.up = false;\n                this._input.down = true;\n                break;\n        }\n\t}\n\n\t/** 松开按键 */\n\tprivate onKeyUp (event: cc.Event.EventKeyboard) {\n        switch (event.keyCode) {\n            case cc.macro.KEY.a:\n                this._input.left = false;\n\t\t\t\tbreak;\n\t\t\tcase cc.macro.KEY.d:\n                this._input.right = false;\n\t\t\t\tbreak;\n\t\t\tcase cc.macro.KEY.w:\n                this._input.up = false;\n                break;\n            case cc.macro.KEY.s:\n                this._input.down = false;\n                break;\n        }\n\t}\n}\n"]}